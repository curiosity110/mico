{% extends 'base.html' %}
{% load i18n static %}

{% block content %}
  <!-- TRUST/PAYMENT BAR (pay in person & invoices) -->
  <div class="bg-white/70 backdrop-blur border-b border-gray-200">
    <div class="container mx-auto px-4 py-2 text-xs sm:text-sm text-gray-700 flex flex-wrap gap-3 items-center justify-center">
      <span class="inline-flex items-center gap-1"><span>ğŸ§¾</span> {% trans 'Invoice provided' %}</span>
      <span class="text-gray-300">â€¢</span>
      <span class="inline-flex items-center gap-1"><span>ğŸ¤</span> {% trans 'Order online, pay in person' %}</span>
      <span class="text-gray-300">â€¢</span>
      <span class="inline-flex items-center gap-1"><span>ğŸ“</span> {% trans 'We may call to confirm if needed' %}</span>
    </div>
  </div>

  <main class="container mx-auto px-4">
    <!-- NEW HERO: split layout (image + copy), green gradient -->
    <section id="hero" class="relative overflow-hidden rounded-3xl bg-gradient-to-tr from-brand-700 via-brand-600 to-brand-500 text-white mt-6">
      <!-- background glyphs -->
      <div class="absolute inset-0 opacity-15 pointer-events-none select-none">
        <div class="absolute -left-6 top-8 text-7xl">ğŸŒ¿</div>
        <div class="absolute right-6 top-12 text-7xl">ğŸ›¡ï¸</div>
        <div class="absolute left-1/3 bottom-8 text-6xl">ğŸ¤</div>
        <div class="absolute right-1/4 bottom-16 text-6xl">ğŸ§¾</div>
      </div>
      <div class="relative grid grid-cols-1 md:grid-cols-2 gap-6 items-center px-6 sm:px-10 py-12 sm:py-16">
        <div>
          <span class="inline-flex items-center gap-2 text-xs font-semibold tracking-wide uppercase bg-white/15 px-3 py-1 rounded-full ring-1 ring-white/20">
            {% trans 'Certified â€¢ Trust-first â€¢ Local' %}
          </span>
          <h1 class="mt-4 text-3xl sm:text-5xl font-extrabold leading-tight">
            {% trans 'Health products you can trust.' %}
          </h1>
          <p class="mt-4 text-white/90 text-base sm:text-lg">
            {% trans 'Order online and pay in person. We provide an invoice and follow up if needed.' %}
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a href="#products" class="inline-flex items-center rounded-xl bg-white text-brand-800 px-6 py-3 text-sm font-semibold shadow-md hover:bg-gray-100">
              {% trans 'Browse Products' %}
            </a>
            <a href="#certs" class="inline-flex items-center rounded-xl border border-white/40 px-6 py-3 text-sm font-semibold hover:bg-white/10">
              {% trans 'View Certificates' %}
            </a>
          </div>

          <!-- mini trust logos row -->
          <div class="mt-8 grid grid-cols-3 sm:grid-cols-5 gap-4 opacity-95">
            <div class="glass rounded-xl p-3 text-center text-xs">ISO 9001</div>
            <div class="glass rounded-xl p-3 text-center text-xs">ISO 22000</div>
            <div class="glass rounded-xl p-3 text-center text-xs">HACCP</div>
            <div class="glass rounded-xl p-3 text-center text-xs">CE</div>
            <div class="glass rounded-xl p-3 text-center text-xs">GMP</div>
          </div>
        </div>

        <div class="relative">
          <div class="aspect-[4/3] rounded-2xl bg-white/10 ring-1 ring-white/20 overflow-hidden shadow-soft">
            <!-- hero image placeholder (replace with your own) -->
            <img src="https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?q=80&w=1200&auto=format&fit=crop"
                 alt="Healthy products"
                 class="w-full h-full object-cover opacity-95">
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT THE FIRM -->
    <section id="about" class="py-12">
      <div class="mb-6">
        <h2 class="text-xl sm:text-2xl font-bold tracking-tight text-gray-900">{% trans 'About Us' %}</h2>
        <p class="text-gray-600 mt-2 max-w-3xl">
          {% trans 'Our company delivers certified health products with transparent service and long-term partnerships.' %}
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="rounded-2xl border border-gray-200 bg-white p-6 card-hover">
          <div class="text-3xl text-brand-600">ğŸ¢</div>
          <h3 class="mt-2 font-semibold text-gray-900">{% trans 'Who we are' %}</h3>
          <p class="text-sm text-gray-600 mt-1">{% trans 'Locally established with vetted partners and compliant facilities.' %}</p>
        </div>
        <div class="rounded-2xl border border-gray-200 bg-white p-6 card-hover">
          <div class="text-3xl text-brand-600">ğŸ§ª</div>
          <h3 class="mt-2 font-semibold text-gray-900">{% trans 'Quality' %}</h3>
          <p class="text-sm text-gray-600 mt-1">{% trans 'ISO/HACCP procedures backed by regular third-party audits.' %}</p>
        </div>
        <div class="rounded-2xl border border-gray-200 bg-white p-6 card-hover">
          <div class="text-3xl text-brand-600">ğŸ¤</div>
          <h3 class="mt-2 font-semibold text-gray-900">{% trans 'Service' %}</h3>
          <p class="text-sm text-gray-600 mt-1">{% trans 'Online ordering with in-person payment and official invoicing.' %}</p>
        </div>
      </div>

      <!-- tiny timeline -->
      <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
        <div class="rounded-xl border border-gray-200 bg-white p-4"><strong>2019</strong> â€” {% trans 'Founded with a focus on wellness.' %}</div>
        <div class="rounded-xl border border-gray-200 bg-white p-4"><strong>2021</strong> â€” {% trans 'Expanded certified product lines.' %}</div>
        <div class="rounded-xl border border-gray-200 bg-white p-4"><strong>2024</strong> â€” {% trans 'Cross-market delivery & 24/7 support.' %}</div>
      </div>
    </section>

    <!-- CERTIFICATES: WORKING CAROUSEL -->
    <section id="certs" class="py-12">
      <div class="mb-6 flex items-end justify-between">
        <h2 class="text-xl sm:text-2xl font-bold tracking-tight text-gray-900">{% trans 'Certificates & Compliance' %}</h2>
        <div class="flex items-center gap-2">
          <!-- Swiper default buttons (already styled in main.css) -->
          <div class="swiper-button-prev certs-prev"></div>
          <div class="swiper-button-next certs-next"></div>
        </div>
      </div>

      <div class="swiper" id="certs-swiper">
        <div class="swiper-wrapper" id="certs-wrapper"></div>
        <!-- dots -->
        <div class="swiper-pagination certs-dots mt-6"></div>
      </div>
    </section>

    <!-- PRODUCTS: dynamic featured -->
    <section id="products" class="py-12">
      <div class="mb-6 flex items-end justify-between">
        <h2 class="text-xl sm:text-2xl font-bold tracking-tight text-gray-900">{% trans 'Featured Products' %}</h2>
        <a href="/products/" class="text-sm text-brand-600 hover:underline">{% trans 'View all' %}</a>
      </div>

      <div class="swiper" id="featured-swiper">
        <div class="swiper-wrapper" id="featured-products"></div>
        <div class="swiper-pagination featured-dots mt-6"></div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="py-12">
      <div class="max-w-lg">
        <h2 class="text-xl sm:text-2xl font-bold tracking-tight text-gray-900">{% trans 'Contact Us' %}</h2>
        <form class="mt-6 space-y-4" method="post">
          {% csrf_token %}
          <div>
            <label class="block text-sm font-medium text-gray-700">{% trans 'Name' %}</label>
            <input class="mt-1 block w-full rounded-xl border-gray-300 focus:border-brand-500 focus:ring-2 focus:ring-brand-500 p-3" type="text" name="name" placeholder="{% trans 'Name' %}">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">{% trans 'Email' %}</label>
            <input class="mt-1 block w-full rounded-xl border-gray-300 focus:border-brand-500 focus:ring-2 focus:ring-brand-500 p-3" type="email" name="email" placeholder="{% trans 'Email' %}">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">{% trans 'Message' %}</label>
            <textarea class="mt-1 block w-full rounded-xl border-gray-300 focus:border-brand-500 focus:ring-2 focus:ring-brand-500 p-3" name="message" rows="4" placeholder="{% trans 'Message' %}"></textarea>
          </div>
          <button class="inline-flex items-center rounded-xl bg-brand-600 text-white px-5 py-3 text-sm font-semibold hover:bg-brand-700 shadow-sm" type="submit">
            {% trans 'Send' %}
          </button>
        </form>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="mt-16">
    <div class="rounded-t-3xl bg-gradient-to-tr from-brand-700 to-brand-800 text-white">
      <div class="container mx-auto px-4 py-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 text-sm">
        <div>
          <div class="text-base font-semibold">{% trans '{{BrandName}}' %}</div>
          <p class="mt-2 text-brand-100/90">{% trans '{{Short brand tagline placeholder}}' %}</p>
        </div>
        <div>
          <div class="font-semibold">{% trans 'Contact Us' %}</div>
          <ul class="mt-2 space-y-1 text-brand-100">
            <li>123 {% trans "Example Street" %}</li>
            <li>+389 70 000 000</li>
            <li><a href="mailto:info@example.com" class="hover:underline text-white">info@example.com</a></li>
          </ul>
        </div>
        <div>
          <div class="font-semibold">{% trans 'Useful Links' %}</div>
          <ul class="mt-2 space-y-1 text-brand-100">
            <li><a href="#about" class="hover:text-white">{% trans 'About Us' %}</a></li>
            <li><a href="#certs" class="hover:text-white">{% trans 'Certificates' %}</a></li>
            <li><a href="#contact" class="hover:text-white">{% trans 'Contact' %}</a></li>
          </ul>
        </div>
        <div>
          <div class="font-semibold">{% trans 'Legal' %}</div>
          <ul class="mt-2 space-y-1 text-brand-100">
            <li><a href="#privacy" class="hover:text-white">{% trans 'Privacy Policy' %}</a></li>
            <li><a href="#terms" class="hover:text-white">{% trans 'Terms & Conditions' %}</a></li>
            <li><a href="#complaints" class="hover:text-white">{% trans 'Complaints' %}</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-brand-700 py-4 text-center text-xs text-brand-100">
        &copy; {{ now|date:"Y" }} {% trans '{{BrandName}}' %} â€” {% trans 'All rights reserved' %}.
      </div>
    </div>
  </footer>
{% endblock %}

{% block scripts %}
<!-- INIT: Certificates & Featured Products -->
<script>
  async function loadCerts() {
    const lang = document.documentElement.lang || 'en';
    try {
      const res = await fetch("{% static 'mock/certificates.json' %}");
      const certs = await res.json();
      const wrapper = document.getElementById('certs-wrapper');
      wrapper.innerHTML = certs.map(c => `
        <div class="swiper-slide">
          <div class="rounded-2xl border border-gray-200 bg-white p-4 h-full card-hover">
            <img src="${c.image_url}" class="w-full h-48 object-cover rounded-lg" alt="${c.name[lang] || c.name.en}">
            <div class="mt-3">
              <div class="text-sm font-semibold">${c.name[lang] || c.name.en}</div>
              <p class="text-xs text-gray-600">${c.description[lang] || c.description.en}</p>
            </div>
          </div>
        </div>
      `).join('');
      new Swiper('#certs-swiper', {
        slidesPerView: 1.2,
        spaceBetween: 16,
        loop: true,
        grabCursor: true,
        breakpoints: {
          640:  { slidesPerView: 2.2, spaceBetween: 20 },
          768:  { slidesPerView: 3,   spaceBetween: 24 },
          1024: { slidesPerView: 4,   spaceBetween: 24 },
        },
        navigation: {
          nextEl: '.certs-next',
          prevEl: '.certs-prev',
        },
        pagination: {
          el: '.certs-dots',
          clickable: true,
        },
        keyboard: { enabled: true },
        mousewheel: { forceToAxis: true },
      });
    } catch (e) {
      console.error(e);
    }
  }

  async function loadFeatured() {
    const lang = document.documentElement.lang || 'en';
    let products = [];
    try {
      const res = await fetch("{% static 'mock/featured_products.json' %}");
      products = await res.json();
    } catch (err) {
      products = [];
    }
    const featured = products.slice(0, 3);
    const wrapper = document.getElementById('featured-products');
    wrapper.innerHTML = featured.map(p => `
      <div class="swiper-slide">
        <div class="rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col">
          <div class="aspect-square overflow-hidden bg-gray-100">
            <img src="${p.image_url || 'https://img.freepik.com/free-vector/illustration-gallery-icon_53876-27002.jpg'}" alt="${p.name[lang] || p.name.en}" class="h-full w-full object-cover">
          </div>
          <div class="p-4 flex flex-col flex-1">
            <h3 class="text-base font-semibold text-gray-900 line-clamp-2">${p.name[lang] || p.name.en}</h3>
            <div class="mt-auto">
              <button data-product-id="${p.id}" class="buy-btn mt-4 inline-flex items-center rounded-xl bg-blue-600 text-white px-4 py-2 text-sm font-semibold hover:bg-blue-700">{% trans 'Buy' %}</button>
            </div>
          </div>
        </div>
      </div>`).join('');

    new Swiper('#featured-swiper', {
      slidesPerView: 1.1,
      spaceBetween: 16,
      loop: true,
      grabCursor: true,
      breakpoints: {
        640:  { slidesPerView: 2.1, spaceBetween: 20 },
        768:  { slidesPerView: 3,   spaceBetween: 24 },
        1024: { slidesPerView: 4,   spaceBetween: 24 },
      },
      pagination: {
        el: '.featured-dots',
        clickable: true,
      },
      keyboard: { enabled: true },
      mousewheel: { forceToAxis: true },
    });

    wrapper.addEventListener('click', function (e) {
      const btn = e.target.closest('.buy-btn');
      if (btn) openOrderModal(btn.dataset.productId);
    });
  }

  loadCerts();
  loadFeatured();
</script>
{% endblock %}
